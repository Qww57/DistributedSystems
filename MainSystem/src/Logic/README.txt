Logic layer for the main system.